\hypertarget{class_picto_1_1_data_state}{\section{Picto\-:\-:Data\-State Class Reference}
\label{class_picto_1_1_data_state}\index{Picto\-::\-Data\-State@{Picto\-::\-Data\-State}}
}


An interface defining many common aspects of classes that extract the various data states from a \hyperlink{namespace_picto}{Picto} Session for playback purposes.  




{\ttfamily \#include $<$Data\-State.\-h$>$}

Inheritance diagram for Picto\-:\-:Data\-State\-:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=9.000000cm]{class_picto_1_1_data_state}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{class_picto_1_1_data_state_a7c0c6a6839540707d1a530690b6aae56}{virtual void \hyperlink{class_picto_1_1_data_state_a7c0c6a6839540707d1a530690b6aae56}{set\-Database} (Q\-Sql\-Database session)=0}\label{class_picto_1_1_data_state_a7c0c6a6839540707d1a530690b6aae56}

\begin{DoxyCompactList}\small\item\em Sets the input Sql Database to this \hyperlink{class_picto_1_1_data_state}{Data\-State} so that it can load all of the data relevant to it into R\-A\-M for quick access. \end{DoxyCompactList}\item 
virtual void \hyperlink{class_picto_1_1_data_state_a8338a5e0c034ccd190e2916e4d60a6e8}{start\-Run} (double run\-Start\-Time, double run\-End\-Time=-\/1)=0
\begin{DoxyCompactList}\small\item\em Informs this \hyperlink{class_picto_1_1_data_state}{Data\-State} that a new run is starting along with the time that the run is starting and the time that it will end (if available). Times are in seconds. \end{DoxyCompactList}\item 
virtual \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} \hyperlink{class_picto_1_1_data_state_aeb01a1209858dc99ce86d153aeda152a}{get\-Current\-Index} ()=0
\begin{DoxyCompactList}\small\item\em Gets the current \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} of this \hyperlink{class_picto_1_1_data_state}{Data\-State}. \end{DoxyCompactList}\item 
virtual \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} \hyperlink{class_picto_1_1_data_state_a959c083fdf897e2f8d75be596d9db8e0}{get\-Next\-Index} (double look\-Forward\-Time)=0
\begin{DoxyCompactList}\small\item\em Gets the \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} of the next available value after the current \char`\"{}read pointer\char`\"{} in this \hyperlink{class_picto_1_1_data_state}{Data\-State}. \end{DoxyCompactList}\item 
virtual void \hyperlink{class_picto_1_1_data_state_af18625b354552d5123f46bde3ded65e0}{move\-To\-Index} (\hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} index)=0
\begin{DoxyCompactList}\small\item\em Moves the current read pointer forward step by step until the next value's index (ie. the thing \hyperlink{class_picto_1_1_data_state_a959c083fdf897e2f8d75be596d9db8e0}{get\-Next\-Index()} will return) is greater than the input index. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
An interface defining many common aspects of classes that extract the various data states from a \hyperlink{namespace_picto}{Picto} Session for playback purposes. 

\char`\"{}\-Data\-State\char`\"{} may not have been the best name for this class. Possibly, something like \char`\"{}\-Session\-Reader\char`\"{} would have made more sense. This interface provides functions for setting a Session database to underlying classes so that they can load the data that they care about into R\-A\-M. It also provides methods for initializing the class for starting a new run and for moving through the underlying data.

Everything here depends on the \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} class which is a simple class that handles timing and ordering data. We can't simply use timestamps in \hyperlink{namespace_picto}{Picto} because everything that happens between two frames can be considered as happening at the same time. The \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} class uses Data\-Id information too to make sure that it gets ordering correct for different pieces of \hyperlink{namespace_picto}{Picto} data. See \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} for more detail.

\begin{DoxyNote}{Note}
One important thing to keep in mind in \hyperlink{class_picto_1_1_data_state}{Data\-State} classes is that all motion between different values must occur continuously, without jumps. This means that if we tell a Frame \hyperlink{class_picto_1_1_data_state}{Data\-State} to move to an input \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} hat is 5 minutes away, it shouldn't use any kind of efficient binary jumping algorithm, it should just move step by step through the data until it reaches the input \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index}. This is because the \hyperlink{class_picto_1_1_data_state}{Data\-State} objects report changes in their data as they step through them and for the purposes of proper playback and valid Analyses we want to make sure that even if someone is trying to \char`\"{}fast forward\char`\"{} through data, all intermediary data states are traversed before the requested position is reached. 
\end{DoxyNote}
\begin{DoxyAuthor}{Author}
Joey Schnurr, Mark Hammond, Matt Gay 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2009-\/2013 
\end{DoxyDate}


Definition at line 44 of file Data\-State.\-h.



\subsection{Member Function Documentation}
\hypertarget{class_picto_1_1_data_state_aeb01a1209858dc99ce86d153aeda152a}{\index{Picto\-::\-Data\-State@{Picto\-::\-Data\-State}!get\-Current\-Index@{get\-Current\-Index}}
\index{get\-Current\-Index@{get\-Current\-Index}!Picto::DataState@{Picto\-::\-Data\-State}}
\subsubsection[{get\-Current\-Index}]{\setlength{\rightskip}{0pt plus 5cm}virtual {\bf Playback\-Index} Picto\-::\-Data\-State\-::get\-Current\-Index (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [pure virtual]}}}\label{class_picto_1_1_data_state_aeb01a1209858dc99ce86d153aeda152a}


Gets the current \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} of this \hyperlink{class_picto_1_1_data_state}{Data\-State}. 

Data\-States, like File objects, have what we can think at as a read pointer. They always have a current position from which we can move. This is for the sake of efficiency and to be sure that every time we move from one state in a \hyperlink{namespace_picto}{Picto} session to another we are not skipping any experimental events in the middle. The value returned from this function is the \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} describing the time/order of the value that the \char`\"{}read pointer\char`\"{} is currently pointing at. \begin{DoxySeeAlso}{See Also}
\hyperlink{struct_picto_1_1_playback_index}{Playback\-Index}, \hyperlink{class_picto_1_1_data_state_af18625b354552d5123f46bde3ded65e0}{move\-To\-Index()} 
\end{DoxySeeAlso}


Implemented in \hyperlink{class_picto_1_1_auto_data_state_a1279148a97c130eef1eab701b77ce113}{Picto\-::\-Auto\-Data\-State}, \hyperlink{class_picto_1_1_lfp_state_a3d1801b8b1f428fa5927633cb2fe0d10}{Picto\-::\-Lfp\-State}, \hyperlink{class_picto_1_1_property_state_a395f83f41df4683d0ebe5d5d6cc56554}{Picto\-::\-Property\-State}, \hyperlink{class_picto_1_1_signal_state_aec41386e0f07f67ed97e03ee9ebc78fc}{Picto\-::\-Signal\-State}, \hyperlink{class_picto_1_1_transition_state_a241eb2839c2b9eac7f929d8a57ec4982}{Picto\-::\-Transition\-State}, \hyperlink{class_picto_1_1_spike_state_a8c6e172c8aee4903ebd8d61b7cf7a398}{Picto\-::\-Spike\-State}, \hyperlink{class_picto_1_1_frame_state_a9a02de9afe1bdbf42c294cabf6e22d74}{Picto\-::\-Frame\-State}, and \hyperlink{class_picto_1_1_reward_state_a01fe049615bb7293f0e44daa762e5ef1}{Picto\-::\-Reward\-State}.

\hypertarget{class_picto_1_1_data_state_a959c083fdf897e2f8d75be596d9db8e0}{\index{Picto\-::\-Data\-State@{Picto\-::\-Data\-State}!get\-Next\-Index@{get\-Next\-Index}}
\index{get\-Next\-Index@{get\-Next\-Index}!Picto::DataState@{Picto\-::\-Data\-State}}
\subsubsection[{get\-Next\-Index}]{\setlength{\rightskip}{0pt plus 5cm}virtual {\bf Playback\-Index} Picto\-::\-Data\-State\-::get\-Next\-Index (
\begin{DoxyParamCaption}
\item[{double}]{look\-Forward\-Time}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [pure virtual]}}}\label{class_picto_1_1_data_state_a959c083fdf897e2f8d75be596d9db8e0}


Gets the \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} of the next available value after the current \char`\"{}read pointer\char`\"{} in this \hyperlink{class_picto_1_1_data_state}{Data\-State}. 


\begin{DoxyParams}{Parameters}
{\em look\-Forward\-Time} & The timespan to search forward from the current read position for the next value. Using an input value less than zero is equivalent to inputing a value of infinity. The function will look forward as far as it takes until a new value is available (which may cause some significant delay). \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
When we designed this interface, the idea was that we could use it for live playback and if there was no \char`\"{}next index\char`\"{} available, the system would just wait for one to come in thereby creating an unfortunate but necessary lag in playback. In practice, we are not using Data\-States for live playback, since we don't support \hyperlink{class_picto_1_1_analysis}{Analysis} during live playback. This may be something to think about when we want to start supporting that though. 
\end{DoxyNote}


Implemented in \hyperlink{class_picto_1_1_auto_data_state_a5b6a6116c29d073fc0b7c990d8d680ab}{Picto\-::\-Auto\-Data\-State}, \hyperlink{class_picto_1_1_lfp_state_ad498c35250a5491f42c57385f0f68da7}{Picto\-::\-Lfp\-State}, \hyperlink{class_picto_1_1_property_state_a416c0397bca9089ddcc2d5ba931c004c}{Picto\-::\-Property\-State}, \hyperlink{class_picto_1_1_signal_state_ac2a6f4cb73c06023d7f9fe94a6bb63df}{Picto\-::\-Signal\-State}, \hyperlink{class_picto_1_1_transition_state_af53afbf44863a578046e98fc95a33d47}{Picto\-::\-Transition\-State}, \hyperlink{class_picto_1_1_spike_state_a66d02a68a15500d10a8dc6a1cd3916b8}{Picto\-::\-Spike\-State}, \hyperlink{class_picto_1_1_frame_state_a89893c7e905929faca4b751ba6e233fa}{Picto\-::\-Frame\-State}, and \hyperlink{class_picto_1_1_reward_state_a3fa159fcfb0b0436339fed73b7338ae0}{Picto\-::\-Reward\-State}.

\hypertarget{class_picto_1_1_data_state_af18625b354552d5123f46bde3ded65e0}{\index{Picto\-::\-Data\-State@{Picto\-::\-Data\-State}!move\-To\-Index@{move\-To\-Index}}
\index{move\-To\-Index@{move\-To\-Index}!Picto::DataState@{Picto\-::\-Data\-State}}
\subsubsection[{move\-To\-Index}]{\setlength{\rightskip}{0pt plus 5cm}virtual void Picto\-::\-Data\-State\-::move\-To\-Index (
\begin{DoxyParamCaption}
\item[{{\bf Playback\-Index}}]{index}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [pure virtual]}}}\label{class_picto_1_1_data_state_af18625b354552d5123f46bde3ded65e0}


Moves the current read pointer forward step by step until the next value's index (ie. the thing \hyperlink{class_picto_1_1_data_state_a959c083fdf897e2f8d75be596d9db8e0}{get\-Next\-Index()} will return) is greater than the input index. 

It is important that the \hyperlink{class_picto_1_1_data_state}{Data\-State} move step by step up to the input index because all of the changes in its value need to be emitted over signals and sent out to the greater playback system as we move to the new value. If we were to jump over any values and skip them, Analyses that are basing themselves on changes in values underlying this \hyperlink{class_picto_1_1_data_state}{Data\-State} might no longer be valid.

Imagine, for example, if this \hyperlink{class_picto_1_1_data_state}{Data\-State} were tracking transitions. If we skipped over any transitions on the way to the input index, \hyperlink{class_picto_1_1_analysis}{Analysis} scripts that are called when those transitions are traversed would be skipped and the \hyperlink{class_picto_1_1_analysis}{Analysis} would be totally invalid. 

Implemented in \hyperlink{class_picto_1_1_auto_data_state_ab1f020f805466b43eddebf93a6e95b3e}{Picto\-::\-Auto\-Data\-State}, \hyperlink{class_picto_1_1_lfp_state_acd6593b8cb11d4aa974b629871eab6dd}{Picto\-::\-Lfp\-State}, \hyperlink{class_picto_1_1_property_state_ab6fd8407780b65caf4a1177c799c8c28}{Picto\-::\-Property\-State}, \hyperlink{class_picto_1_1_signal_state_a0b2ecb912382f2e5605d24ffaca7a093}{Picto\-::\-Signal\-State}, \hyperlink{class_picto_1_1_transition_state_a9a21bdd8867aa905059d4495664735a7}{Picto\-::\-Transition\-State}, \hyperlink{class_picto_1_1_spike_state_adff36be6aba208cd131b253926a18853}{Picto\-::\-Spike\-State}, \hyperlink{class_picto_1_1_frame_state_af81303f5e09d827fbcf1db0c2485ffef}{Picto\-::\-Frame\-State}, and \hyperlink{class_picto_1_1_reward_state_a784e710cbd93bbc245a276b691326b12}{Picto\-::\-Reward\-State}.

\hypertarget{class_picto_1_1_data_state_a8338a5e0c034ccd190e2916e4d60a6e8}{\index{Picto\-::\-Data\-State@{Picto\-::\-Data\-State}!start\-Run@{start\-Run}}
\index{start\-Run@{start\-Run}!Picto::DataState@{Picto\-::\-Data\-State}}
\subsubsection[{start\-Run}]{\setlength{\rightskip}{0pt plus 5cm}virtual void Picto\-::\-Data\-State\-::start\-Run (
\begin{DoxyParamCaption}
\item[{double}]{run\-Start\-Time, }
\item[{double}]{run\-End\-Time = {\ttfamily -\/1}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [pure virtual]}}}\label{class_picto_1_1_data_state_a8338a5e0c034ccd190e2916e4d60a6e8}


Informs this \hyperlink{class_picto_1_1_data_state}{Data\-State} that a new run is starting along with the time that the run is starting and the time that it will end (if available). Times are in seconds. 

This is important because \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} values returned from \hyperlink{class_picto_1_1_data_state}{Data\-State} objects are always with respect to the beginning of the run. In otherwords, if a \hyperlink{class_picto_1_1_data_state}{Data\-State} returns a \hyperlink{struct_picto_1_1_playback_index}{Playback\-Index} of something that happened at the same time that the Run\-Started, its \hyperlink{struct_picto_1_1_playback_index_acbf8f826cfd64d647a098ed165dd3999}{Playback\-Index.\-time()} will be zero, even if the run happened at time 213.\-315. 

Implemented in \hyperlink{class_picto_1_1_auto_data_state_aead300b3fb2e0064194091bc767a2fe7}{Picto\-::\-Auto\-Data\-State}, \hyperlink{class_picto_1_1_lfp_state_a87e3f6635bf617697b1de6a9113f0dfb}{Picto\-::\-Lfp\-State}, \hyperlink{class_picto_1_1_property_state_a737fa799240ff3025a8e6e1949d78fc6}{Picto\-::\-Property\-State}, \hyperlink{class_picto_1_1_signal_state_a9eb44b06fbfaf30a4be39c01af178bf0}{Picto\-::\-Signal\-State}, \hyperlink{class_picto_1_1_transition_state_ace615cb73cff5624ba1c276a04f464e1}{Picto\-::\-Transition\-State}, \hyperlink{class_picto_1_1_spike_state_a8ab8a7793a52c3aebbcd097ae1d060cb}{Picto\-::\-Spike\-State}, \hyperlink{class_picto_1_1_frame_state_a92287dfa13ac812fa3c5e652fb9f0799}{Picto\-::\-Frame\-State}, and \hyperlink{class_picto_1_1_reward_state_ac6bf96667f33664a7b5855b8098ed9f4}{Picto\-::\-Reward\-State}.



The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
source/common/playback/Data\-State.\-h\end{DoxyCompactItemize}
