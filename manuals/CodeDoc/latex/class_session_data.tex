\hypertarget{class_session_data}{\section{Session\-Data Class Reference}
\label{class_session_data}\index{Session\-Data@{Session\-Data}}
}


The base class or objects that stores session data.  




{\ttfamily \#include $<$Session\-Data.\-h$>$}

Inheritance diagram for Session\-Data\-:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=1.671642cm]{class_session_data}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{class_session_data_a5eb5642f14a897c65c31319580b23d5d}{Q\-List$<$ Q\-Variant\-List $>$ \hyperlink{class_session_data_a5eb5642f14a897c65c31319580b23d5d}{peek\-Data} (int data\-Type)}\label{class_session_data_a5eb5642f14a897c65c31319580b23d5d}

\begin{DoxyCompactList}\small\item\em Returns a list of all data stored in this object of the input data\-Type. \end{DoxyCompactList}\item 
void \hyperlink{class_session_data_a20863a2b54c30b1043ff4a87a9908ba9}{copy\-Data\-To} (\hyperlink{class_session_data}{Session\-Data} $\ast$receiver, Q\-Variant condition=Q\-Variant())
\begin{DoxyCompactList}\small\item\em Copies all data in this \hyperlink{class_session_data}{Session\-Data} object to another \hyperlink{class_session_data}{Session\-Data} object. \end{DoxyCompactList}\item 
void \hyperlink{class_session_data_a15c17ef02068f6ec8bf717044c21b487}{move\-Data\-To} (\hyperlink{class_session_data}{Session\-Data} $\ast$receiver, Q\-Variant condition=Q\-Variant())
\begin{DoxyCompactList}\small\item\em Moves all data in this \hyperlink{class_session_data}{Session\-Data} object to another session data object,. \end{DoxyCompactList}\item 
\hypertarget{class_session_data_a36792a7f432c4d8e640a0da5e1aaebbc}{void \hyperlink{class_session_data_a36792a7f432c4d8e640a0da5e1aaebbc}{clear\-Data} ()}\label{class_session_data_a36792a7f432c4d8e640a0da5e1aaebbc}

\begin{DoxyCompactList}\small\item\em Brings this object back into the state it was in when just constructed. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{class_session_data_a7cc8594766473824c591396b187354ad}{add\-Data} (int data\-Type, Q\-Variant\-List data)
\begin{DoxyCompactList}\small\item\em Adds a single data entry to this \hyperlink{class_session_data}{Session\-Data} object of the input type. \end{DoxyCompactList}\item 
void \hyperlink{class_session_data_a72da83d35fc78270dbfef9ba9a2b2b4c}{add\-Data} (int data\-Type, Q\-List$<$ Q\-Variant\-List $>$ data)
\begin{DoxyCompactList}\small\item\em Adds the input Q\-List of Q\-Variant\-List data entries of the input type to this \hyperlink{class_session_data}{Session\-Data} object. \end{DoxyCompactList}\item 
virtual bool \hyperlink{class_session_data_ab41387e7d78a4261524a201c78d1bb97}{start\-Data\-Write} (Q\-String $\ast$error=N\-U\-L\-L)
\begin{DoxyCompactList}\small\item\em Called before the first of a single or batched up calls to \hyperlink{class_session_data_ad05a594d8410d638f1a066bfa5a10ba3}{write\-Data()}. \end{DoxyCompactList}\item 
\hypertarget{class_session_data_ad05a594d8410d638f1a066bfa5a10ba3}{virtual void \hyperlink{class_session_data_ad05a594d8410d638f1a066bfa5a10ba3}{write\-Data} (int data\-Type, Q\-Variant\-List data)=0}\label{class_session_data_ad05a594d8410d638f1a066bfa5a10ba3}

\begin{DoxyCompactList}\small\item\em Write the data of the input data\-Type to this object. \end{DoxyCompactList}\item 
virtual bool \hyperlink{class_session_data_aae9d3e70ed86c81f56f5c063d1a2ff2f}{end\-Data\-Write} (Q\-String $\ast$error=N\-U\-L\-L)
\begin{DoxyCompactList}\small\item\em Called after a completed batch of \hyperlink{class_session_data_ad05a594d8410d638f1a066bfa5a10ba3}{write\-Data()} calls to finalize the data write. Should return false if the data write could not be finalized. \end{DoxyCompactList}\item 
virtual Q\-List$<$ int $>$ \hyperlink{class_session_data_a4b879f10ecfbfcaa12c2dbbc1b15bdff}{read\-Data\-Types} ()=0
\begin{DoxyCompactList}\small\item\em Returns a list of integers representing types of data handled by this object. \end{DoxyCompactList}\item 
virtual Q\-List$<$ Q\-Variant\-List $>$ \hyperlink{class_session_data_a81f4eb49b8a23eb9c1a1575abc2fad4c}{read\-Data} (int data\-Type, Q\-Variant condition, bool cut=false)=0
\begin{DoxyCompactList}\small\item\em Reads all data of the input data\-Type into a Q\-Vector or Variant\-List. \end{DoxyCompactList}\item 
\hypertarget{class_session_data_a002c8f0b7437729ba8f04edf2e91bc06}{virtual void {\bfseries erase\-Everything} ()=0}\label{class_session_data_a002c8f0b7437729ba8f04edf2e91bc06}

\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{class_session_data_a4f56f91d83e09645d853339fe5067181}{Q\-Read\-Write\-Lock \hyperlink{class_session_data_a4f56f91d83e09645d853339fe5067181}{read\-Write\-Lock\-\_\-}}\label{class_session_data_a4f56f91d83e09645d853339fe5067181}

\begin{DoxyCompactList}\small\item\em A Read/\-Write mutex for handling reads and write from multiple threads. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
\hypertarget{class_session_data_ae15f642c4c4da813b65d94b4a68929dd}{class {\bfseries Session\-Data}}\label{class_session_data_ae15f642c4c4da813b65d94b4a68929dd}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
The base class or objects that stores session data. 

There is some history to this class. Originally, we used to create two databases on the server, one file system database, and another very similiar database that was stored in R\-A\-M. We then periodically wrote the cache database out to the file database. When we found that the original system required a lot of complex and costly data access for workstations to join running sessions, we also added a lookup table with the current values of all Properties and other data. This allowed workstations to join up with running sessions more quickly. At one point though, in the process of upgrading our Qt version, we found that we were suddenly getting lots of errors that were crashing the server. With some research we discovered that cached Sqlite databases were only supposed to be accessed by a single thread, and this was causing the crash since the sockets handling \hyperlink{class_director}{Director} and Proxy data, along with the socket handling Workstation data access all had their own threads and were accessing this same cached database.

This class was created to solve that problem. \hyperlink{class_session_data}{Session\-Data} objects support multi-\/threaded access, and can easily write data to one another using the \hyperlink{class_session_data_a20863a2b54c30b1043ff4a87a9908ba9}{copy\-Data\-To()} or \hyperlink{class_session_data_a15c17ef02068f6ec8bf717044c21b487}{move\-Data\-To()} functions. Essentially, the entire \hyperlink{class_session_data}{Session\-Data} system is built to replace the in memory Sqlite database that doesn't support multithreaded access. By understanding the use case, we can get away without all of the S\-Q\-L support that we didn't actually need and simply handle what needs to be done here in our server. By creating a \hyperlink{class_stored_session_data}{Stored\-Session\-Data} \hyperlink{class_session_data}{Session\-Data} class, we have even been able to simplify our S\-Q\-L file interface by hiding it all inside that class and writing to S\-Q\-L by simply copying data from a \hyperlink{class_cached_session_data}{Cached\-Session\-Data} object to a \hyperlink{class_stored_session_data}{Stored\-Session\-Data} object. \begin{DoxyAuthor}{Author}
Joey Schnurr, Mark Hammond, Matt Gay 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2009-\/2013 
\end{DoxyDate}


Definition at line 32 of file Session\-Data.\-h.



\subsection{Member Function Documentation}
\hypertarget{class_session_data_a7cc8594766473824c591396b187354ad}{\index{Session\-Data@{Session\-Data}!add\-Data@{add\-Data}}
\index{add\-Data@{add\-Data}!SessionData@{Session\-Data}}
\subsubsection[{add\-Data}]{\setlength{\rightskip}{0pt plus 5cm}void Session\-Data\-::add\-Data (
\begin{DoxyParamCaption}
\item[{int}]{data\-Type, }
\item[{Q\-Variant\-List}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{class_session_data_a7cc8594766473824c591396b187354ad}


Adds a single data entry to this \hyperlink{class_session_data}{Session\-Data} object of the input type. 


\begin{DoxyParams}{Parameters}
{\em data} & A Variant\-List containing the data entry in a way that should be understandable to anyone working with the input data\-Type.\\
\hline
\end{DoxyParams}
Internally, this just calls the \hyperlink{class_session_data_a72da83d35fc78270dbfef9ba9a2b2b4c}{add\-Data(int,\-Q\-List$<$\-Q\-Variant\-List$>$)} with a list that has only a single Q\-Variant\-List item. 

Definition at line 56 of file Session\-Data.\-cpp.

\hypertarget{class_session_data_a72da83d35fc78270dbfef9ba9a2b2b4c}{\index{Session\-Data@{Session\-Data}!add\-Data@{add\-Data}}
\index{add\-Data@{add\-Data}!SessionData@{Session\-Data}}
\subsubsection[{add\-Data}]{\setlength{\rightskip}{0pt plus 5cm}void Session\-Data\-::add\-Data (
\begin{DoxyParamCaption}
\item[{int}]{data\-Type, }
\item[{Q\-List$<$ Q\-Variant\-List $>$}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}}\label{class_session_data_a72da83d35fc78270dbfef9ba9a2b2b4c}


Adds the input Q\-List of Q\-Variant\-List data entries of the input type to this \hyperlink{class_session_data}{Session\-Data} object. 


\begin{DoxyParams}{Parameters}
{\em data} & A Q\-List of Variant\-List's each of which contains a data entry setup in a way that should be understandable to anyone working with the input data\-Type.\\
\hline
\end{DoxyParams}
Internally, this uses start\-Data\-Write\-And\-Lock() to lock multithreaded access to this object and call \hyperlink{class_session_data_ab41387e7d78a4261524a201c78d1bb97}{start\-Data\-Write()}, then it calls \hyperlink{class_session_data_ad05a594d8410d638f1a066bfa5a10ba3}{write\-Data()} one by one for all data entries, then calls end\-Data\-Write\-And\-Unlock() to call \hyperlink{class_session_data_aae9d3e70ed86c81f56f5c063d1a2ff2f}{end\-Data\-Write()} and unlock multithreaded access to this object. 

Definition at line 69 of file Session\-Data.\-cpp.

\hypertarget{class_session_data_a20863a2b54c30b1043ff4a87a9908ba9}{\index{Session\-Data@{Session\-Data}!copy\-Data\-To@{copy\-Data\-To}}
\index{copy\-Data\-To@{copy\-Data\-To}!SessionData@{Session\-Data}}
\subsubsection[{copy\-Data\-To}]{\setlength{\rightskip}{0pt plus 5cm}void Session\-Data\-::copy\-Data\-To (
\begin{DoxyParamCaption}
\item[{{\bf Session\-Data} $\ast$}]{receiver, }
\item[{Q\-Variant}]{condition = {\ttfamily QVariant()}}
\end{DoxyParamCaption}
)}}\label{class_session_data_a20863a2b54c30b1043ff4a87a9908ba9}


Copies all data in this \hyperlink{class_session_data}{Session\-Data} object to another \hyperlink{class_session_data}{Session\-Data} object. 


\begin{DoxyParams}{Parameters}
{\em receiver} & The \hyperlink{class_session_data}{Session\-Data} object to which data will be copied. \\
\hline
{\em condition} & Some condition that defines which data gets copied. It's meaning is defined in the \hyperlink{class_session_data_a81f4eb49b8a23eb9c1a1575abc2fad4c}{read\-Data()} implementation.\\
\hline
\end{DoxyParams}
Internally, this forwards calls to copy\-Data\-Private() with \char`\"{}false\char`\"{} for the cut condition. 

Definition at line 45 of file Session\-Data.\-cpp.

\hypertarget{class_session_data_aae9d3e70ed86c81f56f5c063d1a2ff2f}{\index{Session\-Data@{Session\-Data}!end\-Data\-Write@{end\-Data\-Write}}
\index{end\-Data\-Write@{end\-Data\-Write}!SessionData@{Session\-Data}}
\subsubsection[{end\-Data\-Write}]{\setlength{\rightskip}{0pt plus 5cm}bool Session\-Data\-::end\-Data\-Write (
\begin{DoxyParamCaption}
\item[{Q\-String $\ast$}]{error = {\ttfamily NULL}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}}\label{class_session_data_aae9d3e70ed86c81f56f5c063d1a2ff2f}


Called after a completed batch of \hyperlink{class_session_data_ad05a594d8410d638f1a066bfa5a10ba3}{write\-Data()} calls to finalize the data write. Should return false if the data write could not be finalized. 

\begin{DoxyNote}{Note}
There is a call to \hyperlink{class_session_data_aae9d3e70ed86c81f56f5c063d1a2ff2f}{end\-Data\-Write()} for every call to \hyperlink{class_session_data_ab41387e7d78a4261524a201c78d1bb97}{start\-Data\-Write()}. 
\end{DoxyNote}


Reimplemented in \hyperlink{class_stored_session_data_a9b226228a31f0721eb58a593f6293aa2}{Stored\-Session\-Data}.



Definition at line 105 of file Session\-Data.\-cpp.

\hypertarget{class_session_data_a15c17ef02068f6ec8bf717044c21b487}{\index{Session\-Data@{Session\-Data}!move\-Data\-To@{move\-Data\-To}}
\index{move\-Data\-To@{move\-Data\-To}!SessionData@{Session\-Data}}
\subsubsection[{move\-Data\-To}]{\setlength{\rightskip}{0pt plus 5cm}void Session\-Data\-::move\-Data\-To (
\begin{DoxyParamCaption}
\item[{{\bf Session\-Data} $\ast$}]{receiver, }
\item[{Q\-Variant}]{condition = {\ttfamily QVariant()}}
\end{DoxyParamCaption}
)}}\label{class_session_data_a15c17ef02068f6ec8bf717044c21b487}


Moves all data in this \hyperlink{class_session_data}{Session\-Data} object to another session data object,. 


\begin{DoxyParams}{Parameters}
{\em receiver} & The \hyperlink{class_session_data}{Session\-Data} object to which data will be copied. \\
\hline
{\em condition} & Some condition that defines which data gets copied. It's meaning is defined in the \hyperlink{class_session_data_a81f4eb49b8a23eb9c1a1575abc2fad4c}{read\-Data()} implementation.\\
\hline
\end{DoxyParams}
Internally, this forwards calls to copy\-Data\-Private() with \char`\"{}true\char`\"{} for the cut condition. 

Definition at line 28 of file Session\-Data.\-cpp.

\hypertarget{class_session_data_a81f4eb49b8a23eb9c1a1575abc2fad4c}{\index{Session\-Data@{Session\-Data}!read\-Data@{read\-Data}}
\index{read\-Data@{read\-Data}!SessionData@{Session\-Data}}
\subsubsection[{read\-Data}]{\setlength{\rightskip}{0pt plus 5cm}virtual Q\-List$<$Q\-Variant\-List$>$ Session\-Data\-::read\-Data (
\begin{DoxyParamCaption}
\item[{int}]{data\-Type, }
\item[{Q\-Variant}]{condition, }
\item[{bool}]{cut = {\ttfamily false}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [pure virtual]}}}\label{class_session_data_a81f4eb49b8a23eb9c1a1575abc2fad4c}


Reads all data of the input data\-Type into a Q\-Vector or Variant\-List. 

The meaning of the condition input is a function of the type of this \hyperlink{class_session_data}{Session\-Data} class. 

Implemented in \hyperlink{class_current_session_data_a1df3ca686975e2c6049666dc06fd497e}{Current\-Session\-Data}, \hyperlink{class_stored_session_data_a5d352c72945a9a5ec4ef9d29c83a283b}{Stored\-Session\-Data}, \hyperlink{class_align_session_data_a88815e5e509175a5a7c1851a9a012c88}{Align\-Session\-Data}, \hyperlink{class_cached_session_data_a772e4f41e01333a090f3e683e4f4e18f}{Cached\-Session\-Data}, and \hyperlink{class_serial_session_data_ae16eba34feb9bfd97dcdfa22c750dedb}{Serial\-Session\-Data}.

\hypertarget{class_session_data_a4b879f10ecfbfcaa12c2dbbc1b15bdff}{\index{Session\-Data@{Session\-Data}!read\-Data\-Types@{read\-Data\-Types}}
\index{read\-Data\-Types@{read\-Data\-Types}!SessionData@{Session\-Data}}
\subsubsection[{read\-Data\-Types}]{\setlength{\rightskip}{0pt plus 5cm}virtual Q\-List$<$int$>$ Session\-Data\-::read\-Data\-Types (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [pure virtual]}}}\label{class_session_data_a4b879f10ecfbfcaa12c2dbbc1b15bdff}


Returns a list of integers representing types of data handled by this object. 

For example, if this \hyperlink{class_session_data}{Session\-Data} handles both Transition traversal and Property value change data, Transition traversal data might be data type 1 and Property value change data might be data type 2 such that this functio would return \{1,2\}. 

Implemented in \hyperlink{class_current_session_data_ae2e23db13e0a70a4afefe6343e54a8a0}{Current\-Session\-Data}, \hyperlink{class_stored_session_data_a621a4d2c9f1b39ac70bc3f2012538465}{Stored\-Session\-Data}, \hyperlink{class_align_session_data_a06d69e9ddd59ad7503a1294677f1663c}{Align\-Session\-Data}, \hyperlink{class_cached_session_data_aa63a22afd537fbaccbf68dee67981018}{Cached\-Session\-Data}, and \hyperlink{class_serial_session_data_a7d47ce8b0be3b922f74c703d0d010bd0}{Serial\-Session\-Data}.

\hypertarget{class_session_data_ab41387e7d78a4261524a201c78d1bb97}{\index{Session\-Data@{Session\-Data}!start\-Data\-Write@{start\-Data\-Write}}
\index{start\-Data\-Write@{start\-Data\-Write}!SessionData@{Session\-Data}}
\subsubsection[{start\-Data\-Write}]{\setlength{\rightskip}{0pt plus 5cm}bool Session\-Data\-::start\-Data\-Write (
\begin{DoxyParamCaption}
\item[{Q\-String $\ast$}]{error = {\ttfamily NULL}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}}\label{class_session_data_ab41387e7d78a4261524a201c78d1bb97}


Called before the first of a single or batched up calls to \hyperlink{class_session_data_ad05a594d8410d638f1a066bfa5a10ba3}{write\-Data()}. 

Should return false if resources needed for data write couldn't be initialized. \begin{DoxyNote}{Note}
There is a call to \hyperlink{class_session_data_aae9d3e70ed86c81f56f5c063d1a2ff2f}{end\-Data\-Write()} for every call to \hyperlink{class_session_data_ab41387e7d78a4261524a201c78d1bb97}{start\-Data\-Write()}. 
\end{DoxyNote}


Reimplemented in \hyperlink{class_stored_session_data_a9ff975024ea9a09048a8e7e14129b357}{Stored\-Session\-Data}.



Definition at line 97 of file Session\-Data.\-cpp.



The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
source/server/connections/Session\-Data.\-h\item 
source/server/connections/Session\-Data.\-cpp\end{DoxyCompactItemize}
