\hypertarget{class_alignment_tool}{\section{Alignment\-Tool Class Reference}
\label{class_alignment_tool}\index{Alignment\-Tool@{Alignment\-Tool}}
}


Calculates the alignment coefficients to move the neural timebase into the behavioral timebase.  




{\ttfamily \#include $<$alignmenttool.\-h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{class_alignment_tool_ad29f55cfe853cdce46f0bc1ccc5df709}{void \hyperlink{class_alignment_tool_ad29f55cfe853cdce46f0bc1ccc5df709}{reset\-Values} ()}\label{class_alignment_tool_ad29f55cfe853cdce46f0bc1ccc5df709}

\begin{DoxyCompactList}\small\item\em Resets \hyperlink{class_alignment_tool}{Alignment\-Tool} variables to their initial values. \end{DoxyCompactList}\item 
\hypertarget{class_alignment_tool_ae9caea7d9dbaf480b6545df6634c6e10}{double \hyperlink{class_alignment_tool_ae9caea7d9dbaf480b6545df6634c6e10}{convert\-To\-Behavioral\-Timebase} (double neural\-Time)}\label{class_alignment_tool_ae9caea7d9dbaf480b6545df6634c6e10}

\begin{DoxyCompactList}\small\item\em Converts the passed in time from neural to behavioral time using the current best fit parameters. \end{DoxyCompactList}\item 
\hypertarget{class_alignment_tool_ae3896af2cf346ba9d090896be7bb5feb}{double \hyperlink{class_alignment_tool_ae3896af2cf346ba9d090896be7bb5feb}{convert\-To\-Neural\-Timebase} (double behavioral\-Time)}\label{class_alignment_tool_ae3896af2cf346ba9d090896be7bb5feb}

\begin{DoxyCompactList}\small\item\em Converts the passed in time from behavioral to neural time using the current best fit parameters. \end{DoxyCompactList}\item 
double \hyperlink{class_alignment_tool_a43752b711ae350128598c28026b4c698}{convert\-Sample\-Period\-To\-Behavioral\-Timebase} (double neural\-Sample\-Period)
\begin{DoxyCompactList}\small\item\em Converts the passed in time span from neural to behavioral time using the current best fit parameters. \end{DoxyCompactList}\item 
double \hyperlink{class_alignment_tool_ae34b218ef3e8558d03d679251a935b00}{convert\-Sample\-Period\-To\-Neural\-Timebase} (double behavioral\-Sample\-Period)
\begin{DoxyCompactList}\small\item\em Converts the passed in time span from behavioral to neural time using the current best fit parameters. \end{DoxyCompactList}\item 
double \hyperlink{class_alignment_tool_a7fbe9b7c8ff096353a292a0da819b3d4}{get\-Jitter} (double b\-Align\-Timestamp, double n\-Align\-Timestamp)
\begin{DoxyCompactList}\small\item\em Returns the jitter between a particular behavioral and neural timestamp (in behavioral time). \end{DoxyCompactList}\item 
double \hyperlink{class_alignment_tool_abd817b37d22c620c71897b1aff2f7d6a}{get\-Correlation\-Coefficient} ()
\begin{DoxyCompactList}\small\item\em Returns the correlation coefficient based on the last call to one of the alignment functions. \end{DoxyCompactList}\item 
double \hyperlink{class_alignment_tool_a347b17cf64237bfcabbef4d3127980da}{get\-Neural\-Offset\-Time} ()
\begin{DoxyCompactList}\small\item\em Returns the Offset of the neural time from the behavioral time (ie. When is behavioral time zero with respect to neural time zero). \end{DoxyCompactList}\item 
double \hyperlink{class_alignment_tool_ad34d5ba3dbada7d66573d725377298f2}{get\-Neural\-Temporal\-Factor} ()
\begin{DoxyCompactList}\small\item\em Returns the neural temporal factor (ie. How much faster does behavioral time increase than neural time). \end{DoxyCompactList}\item 
void \hyperlink{class_alignment_tool_a2c7eadcedb53d5e7f282168c8da3d457}{update\-Coefficients} (double b\-Align\-Timestamp, double n\-Align\-Timestamp)
\begin{DoxyCompactList}\small\item\em Updates the coefficients when a new set of matching timestamps is found. \end{DoxyCompactList}\item 
\hypertarget{class_alignment_tool_abb3151fc1fe9fad725d0c16c503ed8d8}{Q\-String \hyperlink{class_alignment_tool_abb3151fc1fe9fad725d0c16c503ed8d8}{get\-S\-Q\-L\-Jitter\-Equation} (Q\-String jitter\-Column, Q\-String neural\-Timebase\-Column, Q\-String behavioral\-Timebase\-Column, Q\-String correlation\-Column)}\label{class_alignment_tool_abb3151fc1fe9fad725d0c16c503ed8d8}

\begin{DoxyCompactList}\small\item\em This appears to no longer be used and should probably be deleted. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Calculates the alignment coefficients to move the neural timebase into the behavioral timebase. 

There are two seperate timebases in \hyperlink{namespace_picto}{Picto}. The behavioral timebase is used to stamp the events that are recorded/generated by Picto\-Director, while the neural timebase is used by the neural recording device (Plexon, T\-D\-T, etc). This object looks at the event codes that are generated and recorded (almost) simultaneously in both timebases and generates a best fit which can then be used to convert between timebases.

Picto\-Director generates the alignment events and stamps them with its timebase. At approximately the same time, it sends an alignment code to the neural recording device. The alignment code is a 7-\/bit value that rolls-\/over when it reaches 127 (126,127,0,1,...).

The tool assumes a linear alignment such that Behav\-Time = A + B$\ast$\-Neural\-Time. These A and B values can be access from \hyperlink{class_alignment_tool_a347b17cf64237bfcabbef4d3127980da}{get\-Neural\-Offset\-Time()} and \hyperlink{class_alignment_tool_ad34d5ba3dbada7d66573d725377298f2}{get\-Neural\-Temporal\-Factor()}. Alternatively, convenience functions \hyperlink{class_alignment_tool_ae9caea7d9dbaf480b6545df6634c6e10}{convert\-To\-Behavioral\-Timebase()} and \hyperlink{class_alignment_tool_a43752b711ae350128598c28026b4c698}{convert\-Sample\-Period\-To\-Behavioral\-Timebase()} are provided as are their counterparts for converting the timestamps in the opposite direction. \begin{DoxyAuthor}{Author}
Joey Schnurr, Mark Hammond, Matt Gay 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2009-\/2013 
\end{DoxyDate}


Definition at line 31 of file alignmenttool.\-h.



\subsection{Member Function Documentation}
\hypertarget{class_alignment_tool_a43752b711ae350128598c28026b4c698}{\index{Alignment\-Tool@{Alignment\-Tool}!convert\-Sample\-Period\-To\-Behavioral\-Timebase@{convert\-Sample\-Period\-To\-Behavioral\-Timebase}}
\index{convert\-Sample\-Period\-To\-Behavioral\-Timebase@{convert\-Sample\-Period\-To\-Behavioral\-Timebase}!AlignmentTool@{Alignment\-Tool}}
\subsubsection[{convert\-Sample\-Period\-To\-Behavioral\-Timebase}]{\setlength{\rightskip}{0pt plus 5cm}double Alignment\-Tool\-::convert\-Sample\-Period\-To\-Behavioral\-Timebase (
\begin{DoxyParamCaption}
\item[{double}]{neural\-Sample\-Period}
\end{DoxyParamCaption}
)}}\label{class_alignment_tool_a43752b711ae350128598c28026b4c698}


Converts the passed in time span from neural to behavioral time using the current best fit parameters. 

This is like \hyperlink{class_alignment_tool_ae9caea7d9dbaf480b6545df6634c6e10}{convert\-To\-Behavioral\-Timebase()} except that the coeff\-\_\-.\-A offset is not used. 

Definition at line 56 of file alignmenttool.\-cpp.

\hypertarget{class_alignment_tool_ae34b218ef3e8558d03d679251a935b00}{\index{Alignment\-Tool@{Alignment\-Tool}!convert\-Sample\-Period\-To\-Neural\-Timebase@{convert\-Sample\-Period\-To\-Neural\-Timebase}}
\index{convert\-Sample\-Period\-To\-Neural\-Timebase@{convert\-Sample\-Period\-To\-Neural\-Timebase}!AlignmentTool@{Alignment\-Tool}}
\subsubsection[{convert\-Sample\-Period\-To\-Neural\-Timebase}]{\setlength{\rightskip}{0pt plus 5cm}double Alignment\-Tool\-::convert\-Sample\-Period\-To\-Neural\-Timebase (
\begin{DoxyParamCaption}
\item[{double}]{behavioral\-Sample\-Period}
\end{DoxyParamCaption}
)}}\label{class_alignment_tool_ae34b218ef3e8558d03d679251a935b00}


Converts the passed in time span from behavioral to neural time using the current best fit parameters. 

This is like \hyperlink{class_alignment_tool_ae3896af2cf346ba9d090896be7bb5feb}{convert\-To\-Neural\-Timebase()} except that the coeff\-\_\-.\-A offset is not used. 

Definition at line 65 of file alignmenttool.\-cpp.

\hypertarget{class_alignment_tool_abd817b37d22c620c71897b1aff2f7d6a}{\index{Alignment\-Tool@{Alignment\-Tool}!get\-Correlation\-Coefficient@{get\-Correlation\-Coefficient}}
\index{get\-Correlation\-Coefficient@{get\-Correlation\-Coefficient}!AlignmentTool@{Alignment\-Tool}}
\subsubsection[{get\-Correlation\-Coefficient}]{\setlength{\rightskip}{0pt plus 5cm}double Alignment\-Tool\-::get\-Correlation\-Coefficient (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{class_alignment_tool_abd817b37d22c620c71897b1aff2f7d6a}


Returns the correlation coefficient based on the last call to one of the alignment functions. 

The correlation coefficient is a measure of the quality of our least sqaures timing alignment. The closer to one our correlation coefficient is, the better the alignment. 

Definition at line 86 of file alignmenttool.\-cpp.

\hypertarget{class_alignment_tool_a7fbe9b7c8ff096353a292a0da819b3d4}{\index{Alignment\-Tool@{Alignment\-Tool}!get\-Jitter@{get\-Jitter}}
\index{get\-Jitter@{get\-Jitter}!AlignmentTool@{Alignment\-Tool}}
\subsubsection[{get\-Jitter}]{\setlength{\rightskip}{0pt plus 5cm}double Alignment\-Tool\-::get\-Jitter (
\begin{DoxyParamCaption}
\item[{double}]{b\-Align\-Timestamp, }
\item[{double}]{n\-Align\-Timestamp}
\end{DoxyParamCaption}
)}}\label{class_alignment_tool_a7fbe9b7c8ff096353a292a0da819b3d4}


Returns the jitter between a particular behavioral and neural timestamp (in behavioral time). 

In a perfect system, after alignment, behavioral and neural timestamps would be exactly the same. The jitter is the offset of these times after alignment. It results from the fact that the system is not perfect. The event code transmission from \hyperlink{class_director}{Director} to Proxy is not instantaneous. Timestamping on event receipt/creation is not instantaneous, etc. 

Definition at line 77 of file alignmenttool.\-cpp.

\hypertarget{class_alignment_tool_a347b17cf64237bfcabbef4d3127980da}{\index{Alignment\-Tool@{Alignment\-Tool}!get\-Neural\-Offset\-Time@{get\-Neural\-Offset\-Time}}
\index{get\-Neural\-Offset\-Time@{get\-Neural\-Offset\-Time}!AlignmentTool@{Alignment\-Tool}}
\subsubsection[{get\-Neural\-Offset\-Time}]{\setlength{\rightskip}{0pt plus 5cm}double Alignment\-Tool\-::get\-Neural\-Offset\-Time (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{class_alignment_tool_a347b17cf64237bfcabbef4d3127980da}


Returns the Offset of the neural time from the behavioral time (ie. When is behavioral time zero with respect to neural time zero). 

This is A of Behav\-Time = A + B$\ast$\-Neural\-Time. 

Definition at line 95 of file alignmenttool.\-cpp.

\hypertarget{class_alignment_tool_ad34d5ba3dbada7d66573d725377298f2}{\index{Alignment\-Tool@{Alignment\-Tool}!get\-Neural\-Temporal\-Factor@{get\-Neural\-Temporal\-Factor}}
\index{get\-Neural\-Temporal\-Factor@{get\-Neural\-Temporal\-Factor}!AlignmentTool@{Alignment\-Tool}}
\subsubsection[{get\-Neural\-Temporal\-Factor}]{\setlength{\rightskip}{0pt plus 5cm}double Alignment\-Tool\-::get\-Neural\-Temporal\-Factor (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{class_alignment_tool_ad34d5ba3dbada7d66573d725377298f2}


Returns the neural temporal factor (ie. How much faster does behavioral time increase than neural time). 

This is B of Behav\-Time = A + B$\ast$\-Neural\-Time. 

Definition at line 104 of file alignmenttool.\-cpp.

\hypertarget{class_alignment_tool_a2c7eadcedb53d5e7f282168c8da3d457}{\index{Alignment\-Tool@{Alignment\-Tool}!update\-Coefficients@{update\-Coefficients}}
\index{update\-Coefficients@{update\-Coefficients}!AlignmentTool@{Alignment\-Tool}}
\subsubsection[{update\-Coefficients}]{\setlength{\rightskip}{0pt plus 5cm}void Alignment\-Tool\-::update\-Coefficients (
\begin{DoxyParamCaption}
\item[{double}]{b\-Align\-Timestamp, }
\item[{double}]{n\-Align\-Timestamp}
\end{DoxyParamCaption}
)}}\label{class_alignment_tool_a2c7eadcedb53d5e7f282168c8da3d457}


Updates the coefficients when a new set of matching timestamps is found. 

The function updates the running sums, and then uses those to calculate the newest coefficients.

The math is based on\-: \href{http://mathworld.wolfram.com/LeastSquaresFitting.html}{\tt http\-://mathworld.\-wolfram.\-com/\-Least\-Squares\-Fitting.\-html}

\begin{DoxyNote}{Note}
The neural timebase is the x-\/axis, while the behavioral timebase is the y-\/axis 
\end{DoxyNote}


Definition at line 120 of file alignmenttool.\-cpp.



The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
source/server/datacollection/alignmenttool.\-h\item 
source/server/datacollection/alignmenttool.\-cpp\end{DoxyCompactItemize}
