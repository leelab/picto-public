<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Picto: Picto::FrontPanelRewardController Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="pictodoc.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Picto
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>Picto</b></li><li class="navelem"><a class="el" href="class_picto_1_1_front_panel_reward_controller.html">FrontPanelRewardController</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_picto_1_1_front_panel_reward_controller-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Picto::FrontPanelRewardController Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A reward controller for the PictoBox used when running Windows XP -&gt; Windows 7.  
 <a href="class_picto_1_1_front_panel_reward_controller.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_front_panel_reward_controller_8h_source.html">FrontPanelRewardController.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Picto::FrontPanelRewardController:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_picto_1_1_front_panel_reward_controller.png" usemap="#Picto::FrontPanelRewardController_map" alt=""/>
  <map id="Picto::FrontPanelRewardController_map" name="Picto::FrontPanelRewardController_map">
<area href="class_picto_1_1_reward_controller.html" title="This is the base class for classes that provide rewards to the subject of a Picto experiment..." alt="Picto::RewardController" shape="rect" coords="0,56,207,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1513e93f9813613b861d38ef3f58e74b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_front_panel_reward_controller.html#a1513e93f9813613b861d38ef3f58e74b">FrontPanelRewardController</a> ()</td></tr>
<tr class="memdesc:a1513e93f9813613b861d38ef3f58e74b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the reward controller.  <a href="#a1513e93f9813613b861d38ef3f58e74b">More...</a><br /></td></tr>
<tr class="separator:a1513e93f9813613b861d38ef3f58e74b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0971824746bbf2e478fde6e03f835b8c"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_front_panel_reward_controller.html#a0971824746bbf2e478fde6e03f835b8c">~FrontPanelRewardController</a> ()</td></tr>
<tr class="separator:a0971824746bbf2e478fde6e03f835b8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_picto_1_1_reward_controller"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_picto_1_1_reward_controller')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_picto_1_1_reward_controller.html">Picto::RewardController</a></td></tr>
<tr class="memitem:a304c608453d6457840c8ef68d4772345 inherit pub_methods_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a304c608453d6457840c8ef68d4772345"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>RewardController</b> (unsigned int channelCount)</td></tr>
<tr class="separator:a304c608453d6457840c8ef68d4772345 inherit pub_methods_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae46b911316ae8383a92fd62d3e6e0a30 inherit pub_methods_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae46b911316ae8383a92fd62d3e6e0a30"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_reward_controller.html#ae46b911316ae8383a92fd62d3e6e0a30">setRewardVolume</a> (unsigned int channel, float volume)</td></tr>
<tr class="memdesc:ae46b911316ae8383a92fd62d3e6e0a30 inherit pub_methods_class_picto_1_1_reward_controller"><td class="mdescLeft">&#160;</td><td class="mdescRight">This doesn't appear to be used or have any effect and should be removed. <br /></td></tr>
<tr class="separator:ae46b911316ae8383a92fd62d3e6e0a30 inherit pub_methods_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ea32b937d64aeaf7928ee4b696d697b inherit pub_methods_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0ea32b937d64aeaf7928ee4b696d697b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_reward_controller.html#a0ea32b937d64aeaf7928ee4b696d697b">discardOverlapingRewards</a> (bool doIt)</td></tr>
<tr class="memdesc:a0ea32b937d64aeaf7928ee4b696d697b inherit pub_methods_class_picto_1_1_reward_controller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set this to true if rewards that are queued up on a given channel, waiting for the one in progress to finish should just be erased. <br /></td></tr>
<tr class="separator:a0ea32b937d64aeaf7928ee4b696d697b inherit pub_methods_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20eab2fa7e1441b4f54e94332589a3bd inherit pub_methods_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20eab2fa7e1441b4f54e94332589a3bd"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>getChannelCount</b> ()</td></tr>
<tr class="separator:a20eab2fa7e1441b4f54e94332589a3bd inherit pub_methods_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a56936f22612a215077b3ab494b27c5 inherit pub_methods_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1a56936f22612a215077b3ab494b27c5"></a>
QList&lt; QSharedPointer&lt; <a class="el" href="class_picto_1_1_reward_data_unit.html">RewardDataUnit</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_reward_controller.html#a1a56936f22612a215077b3ab494b27c5">getDeliveredRewards</a> ()</td></tr>
<tr class="memdesc:a1a56936f22612a215077b3ab494b27c5 inherit pub_methods_class_picto_1_1_reward_controller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a list of the latest rewards to have been supplied, clearing it in the process. <br /></td></tr>
<tr class="separator:a1a56936f22612a215077b3ab494b27c5 inherit pub_methods_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a64ca898fc2a7295e7ab23d8ac0ce8af2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_front_panel_reward_controller.html#a64ca898fc2a7295e7ab23d8ac0ce8af2">startReward</a> (unsigned int channel, int quantity)</td></tr>
<tr class="memdesc:a64ca898fc2a7295e7ab23d8ac0ce8af2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts a reward an the input channel for the 'quantity' number of milliseconds  old Pictobox5/System10: Due to the limited capabilities of our current version of the NiDaq card, the way that rewards are precisely timed is that we start a clock with frequency equal to the input quantity. We then start a task that switches the A0.0 pin to 0V, then 5V, then 0V, etc, (remember, active low logic) each time the clock triggers. Since we make sure to call <a class="el" href="class_picto_1_1_front_panel_reward_controller.html#a7ffec247d11a69a9fc0f7494aa954311" title="Returns true if the latest reward has been fully supplied, also turns off the reward task in this cas...">rewardWasSupplied()</a> once every 16ms, we can be sure that the reward task will be shut off after the A0.0 pin goes to 5V so long as the reward duration is longer than 16ms. Ideally we would set up the NiDaq task to simply bring the A0.0 pin to 0V, then back to 5V after quantity ms, but Nidaq doesn't support this, so we had to create a work around.  <a href="#a64ca898fc2a7295e7ab23d8ac0ce8af2">More...</a><br /></td></tr>
<tr class="separator:a64ca898fc2a7295e7ab23d8ac0ce8af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ffec247d11a69a9fc0f7494aa954311"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_front_panel_reward_controller.html#a7ffec247d11a69a9fc0f7494aa954311">rewardWasSupplied</a> (unsigned int channel)</td></tr>
<tr class="memdesc:a7ffec247d11a69a9fc0f7494aa954311"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the latest reward has been fully supplied, also turns off the reward task in this case if it is still active.  <a href="#a7ffec247d11a69a9fc0f7494aa954311">More...</a><br /></td></tr>
<tr class="separator:a7ffec247d11a69a9fc0f7494aa954311"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa98123b2113054a5606a634066757e2a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_front_panel_reward_controller.html#aa98123b2113054a5606a634066757e2a">startFlush</a> (unsigned int channel)</td></tr>
<tr class="memdesc:aa98123b2113054a5606a634066757e2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts a flush on the input channel.  <a href="#aa98123b2113054a5606a634066757e2a">More...</a><br /></td></tr>
<tr class="separator:aa98123b2113054a5606a634066757e2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa29df7541e45f4f01aaf2f8f7dd186c3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_front_panel_reward_controller.html#aa29df7541e45f4f01aaf2f8f7dd186c3">stopFlush</a> (unsigned int channel)</td></tr>
<tr class="memdesc:aa29df7541e45f4f01aaf2f8f7dd186c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops an active flush by setting the A0.0 line back to high and then clearing the NiDaq task.  <a href="#aa29df7541e45f4f01aaf2f8f7dd186c3">More...</a><br /></td></tr>
<tr class="separator:aa29df7541e45f4f01aaf2f8f7dd186c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a8112a4ea804c18a57a11f561801192ad"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8112a4ea804c18a57a11f561801192ad"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>hasDevice_</b></td></tr>
<tr class="separator:a8112a4ea804c18a57a11f561801192ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8951f68a22736828c3d0e944d06d64c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae8951f68a22736828c3d0e944d06d64c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>outputData</b> [2]</td></tr>
<tr class="separator:ae8951f68a22736828c3d0e944d06d64c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af135826ee9f0b34ef64f43b5aa0aa7c4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af135826ee9f0b34ef64f43b5aa0aa7c4"></a>
void *&#160;</td><td class="memItemRight" valign="bottom"><b>daqTaskHandle_</b> [5]</td></tr>
<tr class="separator:af135826ee9f0b34ef64f43b5aa0aa7c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac58c5be8338f5ee0167067373f01b559"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac58c5be8338f5ee0167067373f01b559"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>rewardLines_</b> [5]</td></tr>
<tr class="separator:ac58c5be8338f5ee0167067373f01b559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf6bc696a3fef22dabce11bdab9403da"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaf6bc696a3fef22dabce11bdab9403da"></a>
<a class="el" href="class_picto_1_1_stopwatch.html">Stopwatch</a>&#160;</td><td class="memItemRight" valign="bottom"><b>stopwatch_</b> [5]</td></tr>
<tr class="separator:aaf6bc696a3fef22dabce11bdab9403da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad861b9697265a4a7c780923dbced5aa1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad861b9697265a4a7c780923dbced5aa1"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>latestOnTime_</b> [5]</td></tr>
<tr class="separator:ad861b9697265a4a7c780923dbced5aa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_slots_class_picto_1_1_reward_controller"><td colspan="2" onclick="javascript:toggleInherit('pub_slots_class_picto_1_1_reward_controller')"><img src="closed.png" alt="-"/>&#160;Public Slots inherited from <a class="el" href="class_picto_1_1_reward_controller.html">Picto::RewardController</a></td></tr>
<tr class="memitem:a287522c7b84e646e85f5aa85dc49bb74 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_reward_controller.html#a287522c7b84e646e85f5aa85dc49bb74">addReward</a> (unsigned int channel, int quantity, int minRewardPeriod)</td></tr>
<tr class="memdesc:a287522c7b84e646e85f5aa85dc49bb74 inherit pub_slots_class_picto_1_1_reward_controller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends a reward to the list of startable rewards for the input channel and with the input quantity and minRewardPeriod (both in milliseconds).  <a href="#a287522c7b84e646e85f5aa85dc49bb74">More...</a><br /></td></tr>
<tr class="separator:a287522c7b84e646e85f5aa85dc49bb74 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9f9b5b07f824d9078b30cb116ff3323 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_reward_controller.html#ae9f9b5b07f824d9078b30cb116ff3323">triggerRewards</a> (bool appendToList)</td></tr>
<tr class="memdesc:ae9f9b5b07f824d9078b30cb116ff3323 inherit pub_slots_class_picto_1_1_reward_controller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Triggers the next reward from <a class="el" href="class_picto_1_1_reward_controller.html#a287522c7b84e646e85f5aa85dc49bb74" title="Appends a reward to the list of startable rewards for the input channel and with the input quantity a...">addReward()</a> if the previous one on its channel is done.  <a href="#ae9f9b5b07f824d9078b30cb116ff3323">More...</a><br /></td></tr>
<tr class="separator:ae9f9b5b07f824d9078b30cb116ff3323 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbcbd4e26643a6a789ebde84711ea336 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adbcbd4e26643a6a789ebde84711ea336"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_reward_controller.html#adbcbd4e26643a6a789ebde84711ea336">rewardInProgress</a> (unsigned int channel)</td></tr>
<tr class="memdesc:adbcbd4e26643a6a789ebde84711ea336 inherit pub_slots_class_picto_1_1_reward_controller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if there is a reward in progress on the input channel. <br /></td></tr>
<tr class="separator:adbcbd4e26643a6a789ebde84711ea336 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf881b86a594bb618c2901e210d457e5 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abf881b86a594bb618c2901e210d457e5"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_reward_controller.html#abf881b86a594bb618c2901e210d457e5">hasPendingRewards</a> ()</td></tr>
<tr class="memdesc:abf881b86a594bb618c2901e210d457e5 inherit pub_slots_class_picto_1_1_reward_controller"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns true if there are rewards waiting to be supplied on any channel. <br /></td></tr>
<tr class="separator:abf881b86a594bb618c2901e210d457e5 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4380a9f16f4490377ae618096b61ffd1 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4380a9f16f4490377ae618096b61ffd1"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_reward_controller.html#a4380a9f16f4490377ae618096b61ffd1">hasPendingRewards</a> (unsigned int channel)</td></tr>
<tr class="memdesc:a4380a9f16f4490377ae618096b61ffd1 inherit pub_slots_class_picto_1_1_reward_controller"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns true if there are rewards waiting to be supplied on the input channel. <br /></td></tr>
<tr class="separator:a4380a9f16f4490377ae618096b61ffd1 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c6d50f2c4d7b924691090e7f8d4781 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a82c6d50f2c4d7b924691090e7f8d4781"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_reward_controller.html#a82c6d50f2c4d7b924691090e7f8d4781">flush</a> (unsigned int channel, int seconds)</td></tr>
<tr class="memdesc:a82c6d50f2c4d7b924691090e7f8d4781 inherit pub_slots_class_picto_1_1_reward_controller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flushes on the input channel for the input number of seconds. <br /></td></tr>
<tr class="separator:a82c6d50f2c4d7b924691090e7f8d4781 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae54c91a54e1997254bdff6ecedab69bc inherit pub_slots_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae54c91a54e1997254bdff6ecedab69bc"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_reward_controller.html#ae54c91a54e1997254bdff6ecedab69bc">isFlushing</a> (unsigned int channel)</td></tr>
<tr class="memdesc:ae54c91a54e1997254bdff6ecedab69bc inherit pub_slots_class_picto_1_1_reward_controller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if there is a flush in progress on the input channel. <br /></td></tr>
<tr class="separator:ae54c91a54e1997254bdff6ecedab69bc inherit pub_slots_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a2d6ef0210c0699afb60bbcc3422f80 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5a2d6ef0210c0699afb60bbcc3422f80"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_picto_1_1_reward_controller.html#a5a2d6ef0210c0699afb60bbcc3422f80">abortFlush</a> (unsigned int channel)</td></tr>
<tr class="memdesc:a5a2d6ef0210c0699afb60bbcc3422f80 inherit pub_slots_class_picto_1_1_reward_controller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops any active flush on the input channel. <br /></td></tr>
<tr class="separator:a5a2d6ef0210c0699afb60bbcc3422f80 inherit pub_slots_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_class_picto_1_1_reward_controller"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_class_picto_1_1_reward_controller')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="class_picto_1_1_reward_controller.html">Picto::RewardController</a></td></tr>
<tr class="memitem:a51ce15bed088bb162c6d87f79bd64a59 inherit pro_attribs_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a51ce15bed088bb162c6d87f79bd64a59"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>channelCount_</b></td></tr>
<tr class="separator:a51ce15bed088bb162c6d87f79bd64a59 inherit pro_attribs_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6f932bbc885d692776095ce1f907593 inherit pro_attribs_class_picto_1_1_reward_controller"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad6f932bbc885d692776095ce1f907593"></a>
QList&lt; float &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>rewardVolumes_</b></td></tr>
<tr class="separator:ad6f932bbc885d692776095ce1f907593 inherit pro_attribs_class_picto_1_1_reward_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A reward controller for the PictoBox used when running Windows XP -&gt; Windows 7. </p>
<p>PictoBox uses a National Instruments PCIe-6321 data acquisition board to deliver rewards (the same board is used for the 8 analog inputs, 8 digital outputs and event code outputs). As long as PictoBox is running Windows XP-&gt;Windows 7, we can use the traditional NIDAQ MX drivers.</p>
<p>Old Pictobox5/System10 (series E DAQ): The original concept for handling reward controller connections was to simply use the first four lines of port 0 (ie. P0.0-P0.3) for to control the relays that handle the reward outputs. The problem with this was that we wanted to be able to use timers to turn off the pins for precise reward delivery timing. We are theoretically supposed to be able to configure the nidaq card so that digital lines can use clocks from other parts of the card, but I have not yet figured out how to do this correctly. Instead, currently we only support one reward controller where the reward trigger line is the analog output A0.0. We are using A0.1 as the line that enables the relays, so with the current setup we can't use more than one reward line. The reason for using A0.1 as a reward enable line is that if we simply connect reward enable to 5V, then when the Pictobox is restarted, 5V is on the reward enable line, but the A0.0 line defaults to 0V on startup. Since the Crouznet PB-4 Digital I/O board containing our realays uses active low logic to enable the relays, we would therefore end up basically flushing on the reward controller every time we restarted Picto, which would be a bad thing. If we ever need to support multiple reward lines, someone will either have to spend a lot more time than I had working through the NiDaq documentation and experimenting, or, more likely, we will need to purchase an updated NiDaq card that has individual clocks available for 4 output lines.</p>
<p>Newer Pictoboxes (series M DAQ): The intention of the design is for the four free digital output pins tied to the corresponding clocks to control the four reward channels. Currently only one reward channel is connected. Dev/ctr0 outputs through PFI 12 on the card. The other pulse-capable pins are PFI 13, 14, and 15, all currently free.</p>
<p>The digital output PFI 9 is the enable line for the relay board. The High-enable logic is to prevent free rewards from being dispensed when Picto boots up.</p>
<dl class="section note"><dt>Note</dt><dd>The Crouzet PB-4 Digital I/O board uses active low logic to activate the reward relays. </dd></dl>
<dl class="section author"><dt>Authors</dt><dd>Vered Zafrany, Joey Schnurr, Mark Hammond, Matt Gay </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2009-2013 </dd></dl>

<p>Definition at line <a class="el" href="_front_panel_reward_controller_8h_source.html#l00045">45</a> of file <a class="el" href="_front_panel_reward_controller_8h_source.html">FrontPanelRewardController.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a1513e93f9813613b861d38ef3f58e74b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Picto::FrontPanelRewardController::FrontPanelRewardController </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the reward controller. </p>
<p>Attempts to set the reward trigger and then reward enable lines high. This way to provide a reward we need only set the reward trigger line low for the input reward duration. </p><dl class="section note"><dt>Note</dt><dd>If the Nidaq reward tasks fail to start, this is not considered an error here. The reason for this is that the <a class="el" href="class_picto_1_1_front_panel_reward_controller.html" title="A reward controller for the PictoBox used when running Windows XP -> Windows 7. ">FrontPanelRewardController</a> is built to work along side the Legacy Orion application so that there is still the option to run old Orion tasks on PictoBox. If Orion is running, it will be taking control of the reward lines whenever it needs to provide a reward, in which case this reward controller might be locked out of using them temporarily. Either way, someone will be enabling the reward relays though, and so even when Orion is running Front Panel rewards can still be provided unless an Orion reward is already in progress (in which case we don't really care that the front panel reward won't work). </dd></dl>

<p>Definition at line <a class="el" href="_front_panel_reward_controller_8cpp_source.html#l00065">65</a> of file <a class="el" href="_front_panel_reward_controller_8cpp_source.html">FrontPanelRewardController.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0971824746bbf2e478fde6e03f835b8c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Picto::FrontPanelRewardController::~FrontPanelRewardController </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This desructor doesn't need to bring the reward enable line back to zero. Since it's an enable line, it will return to zero automatically as soon as things reset </p>

<p>Definition at line <a class="el" href="_front_panel_reward_controller_8cpp_source.html#l00159">159</a> of file <a class="el" href="_front_panel_reward_controller_8cpp_source.html">FrontPanelRewardController.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a7ffec247d11a69a9fc0f7494aa954311"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Picto::FrontPanelRewardController::rewardWasSupplied </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>channel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns true if the latest reward has been fully supplied, also turns off the reward task in this case if it is still active. </p>
<p>This function should be called at least once every 16ms. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="class_picto_1_1_front_panel_reward_controller.html#a64ca898fc2a7295e7ab23d8ac0ce8af2" title="Starts a reward an the input channel for the &#39;quantity&#39; number of milliseconds  old Pictobox5/System1...">startReward()</a> </dd></dl>

<p>Implements <a class="el" href="class_picto_1_1_reward_controller.html#a213ce91b8ef9019786e96e601d9641b9">Picto::RewardController</a>.</p>

<p>Definition at line <a class="el" href="_front_panel_reward_controller_8cpp_source.html#l00232">232</a> of file <a class="el" href="_front_panel_reward_controller_8cpp_source.html">FrontPanelRewardController.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa98123b2113054a5606a634066757e2a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Picto::FrontPanelRewardController::startFlush </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>channel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Starts a flush on the input channel. </p>
<p>Since flush timing doesn't need to be precise, we don't bother ourselves with creating a clock and using it to control the reward trigger line (as in <a class="el" href="class_picto_1_1_front_panel_reward_controller.html#a64ca898fc2a7295e7ab23d8ac0ce8af2" title="Starts a reward an the input channel for the &#39;quantity&#39; number of milliseconds  old Pictobox5/System1...">startReward()</a>). Here we simply turn the flush on, and the let the call to <a class="el" href="class_picto_1_1_front_panel_reward_controller.html#aa29df7541e45f4f01aaf2f8f7dd186c3" title="Stops an active flush by setting the A0.0 line back to high and then clearing the NiDaq task...">stopFlush()</a>, which the <a class="el" href="class_picto_1_1_reward_controller.html" title="This is the base class for classes that provide rewards to the subject of a Picto experiment...">RewardController</a> should handle, stop it. Since the reward controller should be checking this at least once every 16ms, the resolution is fine as far as the flush is concerned. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="class_picto_1_1_front_panel_reward_controller.html#aa29df7541e45f4f01aaf2f8f7dd186c3" title="Stops an active flush by setting the A0.0 line back to high and then clearing the NiDaq task...">stopFlush()</a>, <a class="el" href="class_picto_1_1_reward_controller.html#ae9f9b5b07f824d9078b30cb116ff3323" title="Triggers the next reward from addReward() if the previous one on its channel is done. ">RewardController::triggerRewards()</a> </dd></dl>

<p>Implements <a class="el" href="class_picto_1_1_reward_controller.html#aaf880507edaa44288cd5b17bdb71f079">Picto::RewardController</a>.</p>

<p>Definition at line <a class="el" href="_front_panel_reward_controller_8cpp_source.html#l00260">260</a> of file <a class="el" href="_front_panel_reward_controller_8cpp_source.html">FrontPanelRewardController.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a64ca898fc2a7295e7ab23d8ac0ce8af2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Picto::FrontPanelRewardController::startReward </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>quantity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Starts a reward an the input channel for the 'quantity' number of milliseconds  old Pictobox5/System10: Due to the limited capabilities of our current version of the NiDaq card, the way that rewards are precisely timed is that we start a clock with frequency equal to the input quantity. We then start a task that switches the A0.0 pin to 0V, then 5V, then 0V, etc, (remember, active low logic) each time the clock triggers. Since we make sure to call <a class="el" href="class_picto_1_1_front_panel_reward_controller.html#a7ffec247d11a69a9fc0f7494aa954311" title="Returns true if the latest reward has been fully supplied, also turns off the reward task in this cas...">rewardWasSupplied()</a> once every 16ms, we can be sure that the reward task will be shut off after the A0.0 pin goes to 5V so long as the reward duration is longer than 16ms. Ideally we would set up the NiDaq task to simply bring the A0.0 pin to 0V, then back to 5V after quantity ms, but Nidaq doesn't support this, so we had to create a work around. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="class_picto_1_1_front_panel_reward_controller.html#a7ffec247d11a69a9fc0f7494aa954311" title="Returns true if the latest reward has been fully supplied, also turns off the reward task in this cas...">rewardWasSupplied()</a></dd></dl>
<p>All other Pictoboxes (not Pictobox5/System10): starts a reward an the input channel for the 'quantity' number of milliseconds</p>
<p>Previous limitations due to the old implementation have been lifted, and now rewards can be given with any amount of pause between. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="class_picto_1_1_front_panel_reward_controller.html#a7ffec247d11a69a9fc0f7494aa954311" title="Returns true if the latest reward has been fully supplied, also turns off the reward task in this cas...">rewardWasSupplied()</a> </dd></dl>

<p>Implements <a class="el" href="class_picto_1_1_reward_controller.html#a3e09bdba141632e89472bef42dc1e132">Picto::RewardController</a>.</p>

<p>Definition at line <a class="el" href="_front_panel_reward_controller_8cpp_source.html#l00183">183</a> of file <a class="el" href="_front_panel_reward_controller_8cpp_source.html">FrontPanelRewardController.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa29df7541e45f4f01aaf2f8f7dd186c3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Picto::FrontPanelRewardController::stopFlush </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>channel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stops an active flush by setting the A0.0 line back to high and then clearing the NiDaq task. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="class_picto_1_1_front_panel_reward_controller.html#aa98123b2113054a5606a634066757e2a" title="Starts a flush on the input channel. ">startFlush()</a> </dd></dl>

<p>Implements <a class="el" href="class_picto_1_1_reward_controller.html#a5a14b4f103def1711b485cc05f4c53bb">Picto::RewardController</a>.</p>

<p>Definition at line <a class="el" href="_front_panel_reward_controller_8cpp_source.html#l00312">312</a> of file <a class="el" href="_front_panel_reward_controller_8cpp_source.html">FrontPanelRewardController.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>source/embedded/frontpanel/<a class="el" href="_front_panel_reward_controller_8h_source.html">FrontPanelRewardController.h</a></li>
<li>source/embedded/frontpanel/<a class="el" href="_front_panel_reward_controller_8cpp_source.html">FrontPanelRewardController.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
